<!-- THIS FILE IS AUTOMATICALLY GENERATED, PLEASE DO NOT EDIT IT MANUALLY -->

# Messaging

All things about messages, typically chats between players.

Sending a message is done with the `messaging/send` request. When the sender
gets a successful response that means the message has been acked by the server
and it'll do its best to send it to the recipient(s).
The server will then send an event `messaging/received` to the recipient(s).
If the recipient is not online, the sender gets the error response `not_connected`.

There is no guarantee that the message has been actually received by the other
player, if, for example, the recipient disconnects at the same time the message
is received. A message can only be sent to online players. There is no support
to store messages to be then delivered later. In short, we're not building
whatsapp or discord.

---
- [received](#received)
- [send](#send)
---

## Received

Notify the player a message has been received

- Endpoint Type: **Event**
- Source: **Server**
- Target: **User**
- Required Scopes: `tachyon.lobby`

### Event

<details>
<summary>JSONSchema</summary>

```json
{
    "title": "MessagingReceivedEvent",
    "tachyon": {
        "source": "server",
        "target": "user",
        "scopes": ["tachyon.lobby"]
    },
    "type": "object",
    "properties": {
        "type": { "const": "event" },
        "messageId": { "type": "string" },
        "commandId": { "const": "messaging/received" },
        "data": {
            "title": "MessagingReceivedEventData",
            "type": "object",
            "properties": {
                "message": { "type": "string" },
                "source": {
                    "type": "object",
                    "properties": {
                        "type": { "const": "player" },
                        "player_id": { "type": "string" }
                    },
                    "required": ["type", "player_id"]
                }
            },
            "required": ["message", "source"]
        }
    },
    "required": ["type", "messageId", "commandId", "data"]
}

```
</details>

<details>
<summary>Example</summary>

```json
{
    "type": "event",
    "messageId": "Duis Lorem",
    "commandId": "messaging/received",
    "data": {
        "message": "Duis Lorem",
        "source": {
            "type": "player",
            "player_id": "Duis Lorem"
        }
    }
}
```
</details>

#### TypeScript Definition
```ts
export interface MessagingReceivedEvent {
    type: "event";
    messageId: string;
    commandId: "messaging/received";
    data: MessagingReceivedEventData;
}
export interface MessagingReceivedEventData {
    message: string;
    source: {
        type: "player";
        player_id: string;
    };
}
```
---

## Send

Send a simple message to the given target.

- Endpoint Type: **Request** -> **Response**
- Source: **User**
- Target: **Server**
- Required Scopes: `tachyon.lobby`

### Request

<details>
<summary>JSONSchema</summary>

```json
{
    "title": "MessagingSendRequest",
    "tachyon": {
        "source": "user",
        "target": "server",
        "scopes": ["tachyon.lobby"]
    },
    "type": "object",
    "properties": {
        "type": { "const": "request" },
        "messageId": { "type": "string" },
        "commandId": { "const": "messaging/send" },
        "data": {
            "title": "MessagingSendRequestData",
            "type": "object",
            "properties": {
                "target": {
                    "type": "object",
                    "properties": {
                        "type": { "const": "player" },
                        "player_id": { "type": "string" }
                    },
                    "required": ["type", "player_id"]
                },
                "message": { "type": "string", "maxLength": 512 }
            },
            "required": ["target", "message"]
        }
    },
    "required": ["type", "messageId", "commandId", "data"]
}

```
</details>

<details>
<summary>Example</summary>

```json
{
    "type": "request",
    "messageId": "consequat Lorem",
    "commandId": "messaging/send",
    "data": {
        "target": {
            "type": "player",
            "player_id": "consequat Lorem"
        },
        "message": "consequat Lorem"
    }
}
```
</details>

#### TypeScript Definition
```ts
export interface MessagingSendRequest {
    type: "request";
    messageId: string;
    commandId: "messaging/send";
    data: MessagingSendRequestData;
}
export interface MessagingSendRequestData {
    target: {
        type: "player";
        player_id: string;
    };
    message: string;
}
```
### Response

<details>
<summary>JSONSchema</summary>

```json
{
    "title": "MessagingSendResponse",
    "tachyon": {
        "source": "server",
        "target": "user",
        "scopes": ["tachyon.lobby"]
    },
    "anyOf": [
        {
            "title": "MessagingSendOkResponse",
            "type": "object",
            "properties": {
                "type": { "const": "response" },
                "messageId": { "type": "string" },
                "commandId": { "const": "messaging/send" },
                "status": { "const": "success" }
            },
            "required": ["type", "messageId", "commandId", "status"]
        },
        {
            "title": "MessagingSendFailResponse",
            "type": "object",
            "properties": {
                "type": { "const": "response" },
                "messageId": { "type": "string" },
                "commandId": { "const": "messaging/send" },
                "status": { "const": "failed" },
                "reason": {
                    "enum": [
                        "message_too_long",
                        "not_connected",
                        "internal_error",
                        "unauthorized",
                        "invalid_request",
                        "command_unimplemented"
                    ]
                },
                "details": { "type": "string" }
            },
            "required": ["type", "messageId", "commandId", "status", "reason"]
        }
    ]
}

```
</details>

<details>
<summary>Example</summary>

```json
{
    "type": "response",
    "messageId": "commodo Lorem",
    "commandId": "messaging/send",
    "status": "success"
}
```
</details>

#### TypeScript Definition
```ts
export interface MessagingSendOkResponse {
    type: "response";
    messageId: string;
    commandId: "messaging/send";
    status: "success";
}
```
Possible Failed Reasons: `message_too_long`, `not_connected`, `internal_error`, `unauthorized`, `invalid_request`, `command_unimplemented`

